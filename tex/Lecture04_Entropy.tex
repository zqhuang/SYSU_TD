\documentclass[CJK]{beamer}
\input{macros.tex}
\input{titlepage.tex}
\title{Lesson 04 - Entropy}
  \author{}
  \date{}
\begin{document}
\tpage{4}{熵}

\section{Reivew}


\section{Entropy}

\begin{frame}
\chtitle{玻尔兹曼的墓碑(Boltzmann's Grave)}
\bch
\bmini{0.55}
\addfig{1.9}{boltzmann_tombstone.jpg}
\emini
\bmini{0.4}
熵 = 微观状态数的对数
\emini
\ech
\end{frame}

\begin{frame}
\chtitle{而当你翻开热学书\bigwulian}
\bch
\bitem
\item{熵=混乱程度(大众理解的熵）

\begin{center}
$S=$ 男生宿舍
\end{center}
}
\item{熵=微观状态数的对数（玻尔兹曼熵）
$$S = k\ln \Omega$$
}
\item{熵=可逆过程的热温比积分(克劳修斯熵)
$$S = \int_{\rm reversible} \frac{\dbar Q}{T}$$
}
\item{$\ldots$}
\eitem

之所以熵这么多（这么混乱），是因为没有清晰地区分场景。

下面我们循序渐进，依次来讨论“概率的熵”，“对象的熵”，“多次重复对象的熵”。
\ech
\end{frame}

\begin{frame}
\chtitle{概率的熵}
\bch
我们假设任何一个{\blue \bf 概率$p$ ($0\le p\le 1$)都对应一个确定的熵，记为$s(p)$}。注意我们并不关心概率描述的事件，而仅仅把熵看成概率的一个函数。(或者，对数学家而言，熵仅仅是某个定义域为$[0,1]$的函数。)

\skipline

对这个我们目前还没有给出明确表达式的函数，先来猜想一下它的性质：

\bitem
\item{概率$p=1$的事件，我们有完整的信息，(猜想）熵为零：$s(1) = 0$。}
\item{概率$p=0$的事件，我们有完整的信息，（猜想）熵为零：$s(0) = 0$。}
\item{概率$0<p<1$的事件，我们有部分的信息，（猜想）熵大于零：$s(p)|_{0<p<1} > 0$。}
\eitem

\ech
\end{frame}


\begin{frame}
\chtitle{思考题}
\bch
\addfig{1}{think3.jpg}
什么概率的熵最大？

\ech
\end{frame}


\begin{frame}
\chtitle{拓宽场景}
\bch

“一个概率有多混乱”这个问题是非常难回答的，为了得到$s(p)$的合理定义，我们必须拓宽熵的应用场景。

\ech
\end{frame}


\begin{frame}
\chtitle{对象(object)和态(state)}
\bch
\bitem
\item{抛硬币有两种态：正面，反面; 每个态的概率为1/2。

\addfig{0.7}{coins.jpg}
}
\item{掷骰子有六种态：1, 2, 3, 4, 5, 6，每个态的概率为1/6。

\addfig{0.3}{touzi.png}
}
\item{修热学课有两种态：

挂科, 概率$0.6$ 

不挂科, 概率$0.4$  {\hskip 0.5in} {\small (\bye 概率是我随便瞎编的)}
}
\eitem

我们把抛硬币，掷骰子，修热学课这些{\bf 包含多种态，每种态的概率都已知的事件称为 “对象”}。

\ech
\end{frame}

\begin{frame}
\chtitle{对象的熵：直接把概率熵加起来就行了}
\bch
设一个对象有$m$种态，它处在各个态的概率分别为$p_1$, $p_2$, $\ldots$, $p_m$。我们把这个对象记作$O(p_1, p_2, \ldots, p_m)$，并定义这个{\bf \blue
对象的熵为
$$S\left[O(p_1, p_2, \ldots, p_m)\right] \equiv \sum_{i=1}^m  s(p_i)$$
}

这是再自然不过的定义了。

\skiplines

\bex
{\small 
抛硬币实验$O(\frac{1}{2},\frac{1}{2})$的熵为$2s(\frac{1}{2})$.

\skipline

掷骰子实验$O(\frac{1}{6},\frac{1}{6},\frac{1}{6},\frac{1}{6},\frac{1}{6},\frac{1}{6})$的熵为$6s(\frac{1}{6})$.

\skipline

修热学课$O(0.6, 0.4)$的熵为$s(0.6)+s(0.4)$.}

\eex
\ech
\end{frame}


\begin{frame}
\chtitle{重复对象的熵}
\bch
{\small 考虑$N$个相同的对象$O(p_1, p_2, \ldots, p_m)$,并把它记作$O_N(p_1, p_2, \ldots, p_m)$。

\addfig{0.7}{many_dice.jpg}

自然而然地，定义{\blue \bf 重复对象$O_N(p_1, p_2, \ldots, p_m)$的熵为：
$$S\left[O_N(p_1, p_2, \ldots, p_m)\right] \equiv N \sum_{i=1}^m  s(p_i)$$
}}

\bex
{\small
$N$次抛硬币的熵为$2Ns(\frac{1}{2})$.

\skipline

$N$次掷骰子的熵为$6Ns(\frac{1}{6})$.

\skipline

$N$次修热学课\wulian的熵为$N\left(s(0.6)+s(0.4)\right)$.}

\eex

\ech
\end{frame}


\begin{frame}
\chtitle{玻尔兹曼有点不开心}
\bch
迄今为止，我们对三种场景定义了熵：概率，包含多个概率的对象，多个重复的对象。按熵可叠加的假设，熵的定义也是自然而然地延拓:
\bitem
\item{每个概率$p$，不论其含义，都唯一地对应一个熵$s(p)$}
\item{包含多种可能性的对象的熵 = 每种可能性的概率的熵之和}
\item{$N$个重复对象的熵 = 单个对象的熵 x $N$}
\eitem

\skiplines

\bmini{0.2}
\addfig{0.5}{boltzmann_tombstone.jpg}
\emini
\bmini{0.75}
玻尔兹曼有点不开森：讲了半天，老子的墓碑呢？
\emini

\ech
\end{frame}


\begin{frame}
\chtitle{完美$N$次测量}
\bch
如果$N$个重复对象的测量结果完全符合统计预期，即任意第$i$个态都精确地出现了$p_i N$次($i=1,2,\ldots,m$)，就称为对象$O(p_1, p_2, \ldots, p_m)$的{\bf \blue 完美$N$次测量}。

\skipline


\bex

如果修100次热学课，挂了60次，过了40次，就是修热学课的完美100次测量。

\eex


\ech
\end{frame}


\begin{frame}
\chtitle{实现方法数$\Omega$}
\bch
例如抛硬币的完美4次测量，必须2次正面，2次反面。实现方法有：

\begin{center}
正正反反 \\
正反正反 \\
正反反正 \\
反正正反 \\
反正反正 \\
反反正正
\end{center}

总共6种。我们记$\Omega= 6$。

\ech
\end{frame}


\begin{frame}
\chtitle{实现方法数$\Omega$ （续）}
\bch
例如修热学课的完美5次测量，必须3次挂，2次过。实现方法有：
 
\begin{center}
{\small
挂挂挂过过 \\
挂挂过挂过 \\
挂挂过过挂 \\
挂过挂挂过 \\
挂过挂过挂 \\
挂过过挂挂 \\
过挂挂挂过 \\
过挂挂过挂 \\
过挂过挂过 \\
过过挂挂挂
}
\end{center}
 
总共10种，记$\Omega = 10$

\ech
\end{frame}


\begin{frame}
\chtitle{实现方法数$\Omega$ （续）}
\bch
一般性地，对象$O(p_1, p_2, \ldots, p_m)$的完美$N$次测量的实现方法数为
$$\Omega = \frac{N!}{(Np_1)!(Np_2)!\ldots (Np_m)!}$$

（不会证的请复习初中排列组合内容\bye）
\skiplines

例如上面的例子$O(0.4, 0.6)$的完美5次测量的实现方法数为：
$$\Omega = \frac{5!}{(5\times 0.4)!(5\times 0.6)!} =  \frac{5!}{2!3!} =10$$
\ech
\end{frame}


\begin{frame}
\chtitle{万事俱备，召唤墓碑}
\bch
记对象$O$的完美$N$次测量的实现方法数为$\Omega$，为了安抚玻尔兹曼，我们希望
$$ S(O) = \lim_{N\rightarrow \infty} \frac{\ln \Omega}{N}$$ 

当然，我们暂时抛开了无关紧要的常数$k$ (它只是重新定义了熵的单位而已）。

代入$\Omega$的表达式，即有
$$\sum_{i=1}^m s(p_i) = \lim_{N\rightarrow\infty} \frac{\ln \left(\frac{N!}{(Np_1)!(Np_2)!\ldots(Np_m)!}\right) }{N}$$

\ech
\end{frame}


\begin{frame}
\chtitle{Stirling公式}
\bch
当$N$很大时，忽略小于$O(N)$的项：
\bmini{0.45}
\bea
\ln (N!) &=& \sum_{i=1}^N \ln i \newl
	&\approx & \int_1^{N} \ln x \,dx \newl
	&=& \left.\left(x\ln x - x\right)\right\vert_1^N \newl
	&\approx& N\ln N - N
\eea
\emini
\bmini{0.5}
{\vskip 0.3in}

(请无视数学老师幽怨的眼神)
\emini

于是我们得到
$$\sum_{i=1}^m s(p_i) = \lim_{N\rightarrow\infty} \frac{N\ln N - N - \sum_{i=1}^m \left[Np_i \ln (Np_i) - Np_i\right] }{N}$$

\ech
\end{frame}


\begin{frame}
\chtitle{概率熵的表达式}
\bch
最后，我们利用 $\sum_{i=1}^m p_i = 1$，化简得到
$$\sum_{i=1}^m s(p_i) = -\sum_{i=1}^m p_i \ln (p_i) $$

很显然，唯一能令玻尔兹曼开心的办法是{\blue \bf
定义概率熵为：
$$s(p) = - p \ln p$$
}

\skiplines

{\small 注意：当$p=0$时，$s(p) = \lim_{p\rightarrow 0^+} (-p\ln p) = 0$.


我们不仅可以验证之前关于$s(p)$的若干猜想，还可以算出$e^{-1} \approx 0.368$是“最混乱”的概率。
}


\ech
\end{frame}



\begin{frame}
\chtitle{熵函数是个凸函数(concave function)}
\bch
\bmini{0.65}
\addfig{2.6}{xlnx.pdf}
\emini
\bmini{0.3}
在某区间内部二阶导数恒为负数的函数是该区间内的凸函数。

对$0<p<1$
$$s''(p)  = -\frac{1}{p}<0$$
\emini
\ech
\end{frame}


\begin{frame}
\chtitle{琴生不等式(Jensen's Inequality)}
\bch
多个概率的熵满足下面的不等式（{\blue 概率的熵的平均不大于平均概率的熵}）：
$$\frac{1}{m}\sum_{i=1}^m s(p_i) \le  s\left(\frac{1}{m}\sum_{i=1}^m p_i\right)$$
或者简写为{\blue
$$\overline{s(p)} \le s(\bar{p})$$
等号当且仅当所有$p_i$均相等时取到}。


\skiplines

这个不等式其实对所有凸函数都成立 （20秒还没有想出怎么证明的要好好补习下高数了\bye）
\ech
\end{frame}


\begin{frame}
\chtitle{等概率原理}
\bch
考虑对象$O(p_1, p_2,\ldots, p_m)$, 由于总概率为$1$，平均概率是固定的$\bar{p} =  \frac{1}{m}$。于是由琴生不等式：
$$ S = m\, \overline{s(p)} \le m s(\bar{p}) = m\, s\left(\frac{1}{m}\right) = \ln m$$
等号当且仅当所有$p_i$相等时才能取到。

\skipline

{\bf \blue 态的个数固定的对象，如果没有额外条件的约束，则当所有态的概率相等时，熵达到最大。}这时我们拥有的信息量为零（不知道哪种可能性更容易发生）。

\ech
\end{frame}

\begin{frame}
\chtitle{例子：抛硬币游戏的熵}
\bch

\bmini{0.4}
\addfig{1}{coins.jpg}
\emini
\bmini{0.55}
抛硬币，如果正面向上概率为$x$，反面向上概率为$1-x$，则熵为
$$S = -x\ln x - (1-x)\ln (1-x)$$
通过求导易求出$x = 1/2$时熵最大，为$S_{\max} = \ln 2$。

和等概率原理的结论一致。
\emini

\skiplines

如果我们知道硬币是动过手脚的（有额外约束条件），$x\ne 1/2$，那么熵就要小一点了。
\ech
\end{frame}


\begin{frame}
\chtitle{抛骰子游戏的熵}
\bch
\bmini{0.2}
\addfig{0.5}{touzi.png}
\emini
\bmini{0.75}
掷骰子，根据等概率原理，当且仅当所有$p_i$为$1/6$时熵取到最大值$S_{\max} = \ln 6$.
\emini

\skiplines

\bmini{0.45}
\addfig{1.2}{fage_touzi.jpg}
\emini
\bmini{0.5}
如果我们知道谁在掷骰子（有额外约束条件），就不好说了。
\emini
\ech
\end{frame}


\begin{frame}
\chtitle{掷骰子——比小——出老千}
\bch
现在我们去趟澳门，跟赌王掷骰子比小。

\skipline

江湖险恶，十赌九骗，赌王用的是一个高科技骰子。

\addfig{1.2}{fage_touzi.jpg}

\skipline

如果结果为$6$，则会触发骰子里的老千系统，使下一次出现1的概率为1/2，出现2至6中任何一个概率都是1/10。

如果连续多次地投掷骰子，每次掷骰子的熵变为多少了呢？

\skiplines

显然这时由于老千系统（额外约束条件），熵不再是$S = \ln 6$了。

\ech
\end{frame}


\begin{frame}
\chtitle{掷骰子——比小——出老千（续）}
\bch
{\small
这个老千系统比较简单，很容易列出方程：
\bea
p_1 &=& \frac{1}{2}p_6 + \frac{1}{6}(1-p_6) \newl
p_2 &=& \frac{1}{10}p_6 + \frac{1}{6}(1-p_6) \newl
p_3 &=& \frac{1}{10}p_6 + \frac{1}{6}(1-p_6) \newl
p_4 &=& \frac{1}{10}p_6 + \frac{1}{6}(1-p_6) \newl
p_5 &=& \frac{1}{10}p_6 + \frac{1}{6}(1-p_6) \newl
p_6 &=& \frac{1}{10}p_6 + \frac{1}{6}(1-p_6) 
\eea
解出$ p_2 = p_3 = p_4 = p_5 =p_6= 5/32$, $p_1= 7/32$.

熵 $ S = 1.783 < \ln 6 = 1.792$. 这个老千系统只让熵变小了$0.01$.
}
\ech
\end{frame}


\begin{frame}
\chtitle{别小看老千系统}
\bch
但是，可别小看这0.01的熵差。如果你跟赌王掷了10000次骰子，熵差就变为100。

\addfig{1}{bufuzailai.jpg}

如果你还记得玻尔兹曼的墓碑，你就明白赌王通过出老千，得到了一个看起来概率约为$e^{-100}$的“小概率事件”！
\ech
\end{frame}


\begin{frame}
\chtitle{上帝的老千}
\bch
{\small
现在让我们回到物理世界，考虑在相空间有多个可能态的微观粒子。

\skipline

虽然粒子之间可以发生“碰撞”使态发生变化，但“碰撞”受到自然法则的约束：任何碰撞过程能量守恒。

\skiplines

{\blue \bf 能量守恒——这就是上帝出的老千。}
}

\skiplines

下面让我们通过研究一个粒子数守恒的封闭系统来揭秘上帝的老千的工作原理。
\ech
\end{frame}

\begin{frame}
\chtitle{揭秘上帝的老千}
\bch
{\small
\bitem
\item{设处于$a$,$b$两态的粒子可以发生碰撞，成为$a'$, $b'$两态的粒子。单位时间内$a+b\rightarrow a'+b'$发生概率为$\Gamma(a, b; a', b')$。}
\item{{\blue 假设微观物理是时间反演对称的}，则逆过程$a'+b'\rightarrow a+b$的发生概率相等$\Gamma(a', b'; a, b) = \Gamma(a, b; a', b')$。}
\item{设共有$N$个粒子，考虑粒子在$a$态出现的概率$p_a$随时间的演化：
$$\frac{d (Np_a)}{dt} = N^2\sum_{b;a',b'} (p_{a'}p_{b'}  -  p_a p_b) \Gamma(a, b; a', b')$$
}
\item{把多粒子系统看成“$N$个重复对象”，其熵随时间的演化：
$$\frac{d S}{dt} = -N\sum_a\frac{dp_a}{dt}(\ln p_a+1) = -N\sum_a\frac{dp_a}{dt}\ln p_a  $$
}
\eitem
}
\ech
\end{frame}

\begin{frame}
\chtitle{揭秘上帝的老千(续）}
\bch
{\small
\bitem
\item{于是我们得到
$$\frac{d S}{dt} =  N^2 \sum_{a, b; a', b'}\Gamma(a, b; a', b') \left(p_ap_b - p_{a'}p_{b'}\right)\ln p_a    $$
}
\item{我们当然可以把求和指标$a, b$互换，则上式变成
$$\frac{d S}{dt} =  N^2 \sum_{a, b; a', b'}\Gamma(a, b; a', b') \left(p_ap_b - p_{a'}p_{b'}\right)\ln p_b    $$
}
\item{上面两式相加得到
$$\frac{d S}{dt} =  \frac{N^2}{2} \sum_{a, b; a', b'}\Gamma(a, b; a', b') \left(p_ap_b - p_{a'}p_{b'}\right)\ln(p_ap_b)    $$
}
\item{我们当然可以把$a,b$和$a',b'$互换得到：
$$\frac{d S}{dt} =  \frac{N^2}{2} \sum_{a, b; a', b'}\Gamma(a', b'; a, b) \left(p_{a'}p_{b'} - p_ap_b\right)\ln(p_{a'}p_{b'})    $$
}

\eitem
}
\ech
\end{frame}

\begin{frame}
\chtitle{细致平衡}
\bch
{\small
\bitem
\item{把前页的最后两式相加，得到
$$\frac{d S}{dt} =  \frac{N^2}{4} \sum_{a, b; a', b'}\Gamma(a, b; a', b') \left(p_ap_b - p_{a'}p_{b'}\right)\ln(\frac{p_ap_b}{p_{a'}p_{b'}})    $$
}
\eitem

显然，只要任何一个$p_ap_b\ne p_{a'}p_{b'}$上式右边就是正的，熵会持续增大，直到{\blue 所有的 
$$p_ap_b = p_{a'}p_{b'}$$}
这称为{\blue细致平衡条件。}

当细致平衡条件满足时，我们认为该孤立系统达到了热平衡，它的熵达到了最大并不再变化。
}

\ech
\end{frame}

\begin{frame}
\chtitle{热力学温度}
\bch
{
热平衡时，所有“碰撞”过程$a+b \rightarrow a'+b'$都需要满足细致平衡条件：
$$\ln p_a + \ln p_b = \ln p_{a'} + \ln p_{b'}$$
在微观上，这是一条碰撞过程的守恒律。显然，把一大堆粒子放在一起并不会产生新的微观守恒律，那么它必然是一条已有的守恒律。

}
\ech
\end{frame}

\begin{frame}
\chtitle{热力学温度（续）}
\bch

$$\ln p_a + \ln p_b = \ln p_{a'} + \ln p_{b'}$$

\skipline

在微观上有能量守恒定律和三个方向上的动量守恒定律，看来让$\ln p_a$和能量或者动量的任何一个分量成线性关系即可满足条件?

\skipline

问题是，无论让$\ln p_a$和哪个方向上的动量成线性关系都将破坏{\blue 微观规律的空间对称性}。


\ech
\end{frame}

\begin{frame}
\chtitle{热力学温度(续）}
\bch

$$\ln p_a + \ln p_b = \ln p_{a'} + \ln p_{b'}$$

\skipline

至此，我们别无选择，只能要求对所有的态$a$，$\ln p_a$和能量$\varepsilon_a$成线性关系。另外，我们知道态的能量趋向无穷时，在该态出现的概率就趋向于零，所以$\ln p_a$和$\varepsilon_a$之间的是负线性相关。不妨设

$$\ln p_a = -\frac{\varepsilon_a - \mu}{T}$$

$T>0$和$\mu$为能量量纲的常量。很快，你会发现这样定义的$T$的数值往往太大，需要重新取一个合适的单位，于是就有了把$T$换成$kT$以及之后的热力学温度的一系列故事。
\ech
\end{frame}


\begin{frame}
\chtitle{最后，照顾一下克劳修斯的感受}
\bch
考虑一个单纯加热（无做功）的微小可逆过程：

由
$$dS = -N \sum_a dp_a \ln p_a = \frac{N}{T}\sum (\varepsilon_a-\mu) dp_a = \frac{N}{T}\sum \varepsilon_a  dp_a $$

即得

$$\dbar Q = N\sum_a \epsilon_a d p_a = T dS $$

其他更复杂的情况不再深入讨论。

\ech
\end{frame}

\begin{frame}
\chtitle{熵的总结}
\bch
我们以后会学到，能量动量守恒定律是时间和空间平移对称性的结果。那么上面的所有的推导，除了随机初条件（即开始时没有额外限制条件）之外，我们只用到了时间和空间的各种对称性。

\skipline
正是因为熵的单向性，覆水难收，我们无法抹平记忆，回到过去，于是才会有了时间的方向。

\tbox{
 随机初始条件 + 微观世界的时间和空间对称性 $\Rightarrow$ 宏观世界时间的方向
}

是不是不可思议！

\ech
\end{frame}



\begin{frame}
\chtitle{第四周作业(序号接第三周）}
\bch
\bitem
\item[10]{教材习题2-7}
\item[11]{教材习题2-22}
\item[12]{教材习题2-23}
\eitem
\ech
\end{frame}

\end{document}
