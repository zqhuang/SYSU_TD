\documentclass[CJK]{beamer}
\input{macros.tex}
\input{titlepage.tex}
\title{Lesson 06 - Leakage Velocity, Boltzmann Distribution}
  \author{}
  \date{}
\begin{document}
\tpage{6}{泻流速率，玻尔兹曼分布}

\section{Reivew}

\begin{frame}
\chtitle{上讲内容回顾}
\bch
{\large
\bitem
\item{径向概率密度函数:
$$F(r) = \frac{G_1}{G_{n-1}} r^{n-1} e^{-r^2/2}.$$}
\item{麦克斯韦分布:
以$\sqrt{\frac{kT}{m}}$为速度单位，每个维度上的速度分量服从标准正态分布。
}
\eitem}
\ech
\end{frame}

\begin{frame}
\chtitle{本讲内容}
\bch
\bitem
\item{极坐标和球坐标的概率密度函数}  
\item{泻流速率}
\item{玻尔兹曼分布}  
\eitem
\ech
\end{frame}

\section{Polar/Spherical Coordinates}

\secpage{极坐标和球坐标的概率密度函数}{
  $$ F(r,\theta) = r\, f(x,y) $$
$$ F(r,\theta,\varphi) = r^2\sin\theta\, f(x,y,z) $$}




\begin{frame}
\chtitle{极坐标系的面积元}
\bch

    \bmini{0.55}
    \lfig{2}{polar_area_element.png}
    \emini
    \bmini{0.4}
          {\large
            小矩形的边长分别是$dr$和$r d\theta$，相乘即得到面积元

$$ dA =  r dr d\theta.  $$            
}
    \emini
\ech
\end{frame}

\begin{frame}
\chtitle{思考题}
\bch
\addfig{0.5}{think2.jpg}
{\large
如果根据$x=r\cos\theta$, $y=r\sin\theta$，计算
$$dx dy = (\cos\theta dr - r\sin\theta d\theta)(\sin\theta dr + r\cos\theta d\theta) = \ldots $$
这样为什么得不到正确的极坐标面积元 $rdrd\theta$？

\skipline

我们通常说的直角坐标$dxdy$等价于极坐标$r dr d\theta$是什么意思？}
\ech
\end{frame}


\begin{frame}
\chtitle{思考题}
\bch
\addfig{0.5}{think.jpg}

{\Large
如果已知随机点$(x,y)$的概率密度函数$f(x,y)$，定义新的随机变量$(r,\theta)$为$(x,y)$的极坐标，那么$(r,\theta)$的概率密度函数$F(r,\theta)$是什么呢？}

\ech
\end{frame}

\begin{frame}
\chtitle{极坐标二元变量的概率密度函数}
\bch

{\large
  利用概率元不变
  $$ F(r,\theta) dr d\theta = f(x, y) dx dy = f(r\cos\theta,r\sin\theta) r dr d\theta$$
  两边约去$dr d\theta$即得
  \tbox{
  $$ F(r,\theta) = r\, f(r\cos\theta, r\sin\theta).$$}}
{\small
  {\bf 再强调一遍：不管你写$f(x,y)$，还是$f(r\cos\theta, r\sin\theta)$，它都是$(x,y)$的概率密度函数，满足归一化条件$$\int_{-\infty}^\infty dx \int_{-\infty}^\infty dy f(x,y) = \int_0^\infty rdr \int_0^{2\pi} d\theta\, f(r\cos\theta,r\sin\theta) = 1 $$
    而$(r,\theta)$的概率密度函数$F(r,\theta)$满足的是
    $$ \int_0^\infty dr \int_0^{2\pi}d\theta\, F(r,\theta) = 1 $$
  }}
    

\ech
\end{frame}


\begin{frame}
\chtitle{球坐标的体积元}
\bch

\addfig{2.5}{sphericalcoor.png}
    {\large
      球坐标的体积元$ dr (rd\theta)(r\sin\theta d\varphi) = r^2 \sin\theta \,dr d\theta d\varphi$。
    }
\ech
\end{frame}


\begin{frame}
\chtitle{球坐标三元变量的概率密度函数}
\bch

       {\large
         同样，根据概率元不变写出：}
       \bea
       && F(r,\theta,\varphi)\,dr d\theta d\varphi \newl
       &=& f(x,y,z) dx dy dz  \newl
       &=& f(r\sin\theta\cos\varphi, r\sin\theta\sin\varphi, r\cos\theta) r^2\sin\theta \,dr d\theta d\varphi \nonumber
       \eea
         即\tbox{
$$ F(r,\theta,\varphi) =  r^2\sin\theta\, f(r\sin\theta\cos\varphi, r\sin\theta\sin\varphi, r\cos\theta).$$}         
\ech
\end{frame}


\begin{frame}
\chtitle{总结}
\bch
二维的极坐标变量$(r,\theta)$的概率密度函数：
\tbox{
  $$ F(r,\theta) = r\, f(r\cos\theta, r\sin\theta).$$}
三维球坐标变量$(r,\theta,\varphi)$的概率密度函数
\tbox{
  $$ F(r,\theta,\varphi) =  r^2\sin\theta\, f(r\sin\theta\cos\varphi, r\sin\theta\sin\varphi, r\cos\theta).$$}


对于一般的变量替换，则要复杂一些，可以参考附录给出的Jacobi行列式（必杀技)。

\ech
\end{frame}


\begin{frame}
\chtitle{思考题}
\bch

\addfig{0.5}{think3.jpg}
{\large
  速度的直角坐标形式$(\upsilon_x,\upsilon_y, \upsilon_z)$也可以替换为（速度空间的）球坐标$(\upsilon,\theta,\varphi)$。请对单一成分的平衡态理想气体
  \bitem
\item{写出$(\upsilon,\theta,\varphi)$的概率密度函数。}
\item{对$\theta,\varphi$积分，投影得到速率$\upsilon$的概率密度函数，并和上节课得到的结果进行比较。}
\item{对$\upsilon,\varphi$积分，投影得到$\theta$的概率密度函数}
\item{计算$\upsilon_x>\frac{1}{4}\upsilon$的概率。}
\item{计算$\upsilon_x> \sqrt{3} |\upsilon_z|$的概率。}  
  \eitem
}
\ech
\end{frame}




\section{Leakage Velocity}

\secpage{泻流速率}{（三维）各向同性的情况下总是平均速率的$1/4$}

\begin{frame}
\chtitle{泻流速率}
\bch
{\large
  泻流速率$\vleak$定义为：{\blue 单位时间从容器壁单位面积的小孔上逸出的分子数和容器内分子数密度之比。}

  \skipline
  
  取小孔所在平面为$xy$平面，速度分布函数为$f(\upsilon_x,\upsilon_y,\upsilon_z)$，则有
\tbox{  $$\vleak = \overline{\frac{\upsilon_z + |\upsilon_z|}{2}}$$}
  教材上也把$\frac{\upsilon_z + |\upsilon_z|}{2}$简写为$\upsilon_z^+$，意思是只取正的$\upsilon_z$。
 
}

\ech
\end{frame}



\begin{frame}
\chtitle{思考题}
\bch

\addfig{1}{think1.jpg}

{\large
  计算温度为T，分子质量为$m$的理想气体的泻流速率。
}

\ech
\end{frame}


\begin{frame}
\chtitle{结果}
\bch
{\large
以$\sqrt{\frac{kT}{m}}$为单位，$\upsilon_z$满足标准正态分布，所以
$\overline{\upsilon_z} = 0$, $\overline{|\upsilon_z|} = G_1 = \sqrt{\frac{2}{\pi}}$。结果就是
$$\vleak = \frac{1}{2}\sqrt{\frac{2}{\pi}} = \frac{1}{\sqrt{2\pi}} $$
当然，最后结果要把$\sqrt{\frac{kT}{m}}$乘回去。

\skipline

我们发现$\vleak$是平均速率$\overline{\upsilon}$的$\frac{1}{4}$，这是偶然的吗？}
\ech
\end{frame}


\begin{frame}
\chtitle{思考题}
\bch

\addfig{1}{think2.jpg}

{\large
如果三维空间的分子的速度分布是各向同性的，证明泻流速率一定是平均速率的$1/4$。（二维的情况则是$\frac{1}{\pi}.$)
}

\ech
\end{frame}

\section{Boltzmann Distribution}

\secpage{玻尔兹曼分布}{重分子喜欢往势能低的地方扎堆}

\begin{frame}
\chtitle{重力势能的情况}
\bch
{\large
假设沿$z$方向有强度为$g$的重力场，则分子的能量
$$\varepsilon = \frac{1}{2}m\upsilon^2 + mgz$$

按照“万能法则”，分子在相空间某小块(设坐标为$(x, y, z, \upsilon_x, \upsilon_y, \upsilon_z)$）出现的概率正比于：

$$f_{MB}(x, y, z, \upsilon_x, \upsilon_y,\upsilon_z) \propto e^{-\frac{\frac{1}{2}m\upsilon^2 + mgz}{kT}}$$

注意这是个六维空间的概率密度函数。
}
\ech
\end{frame}

\begin{frame}
\chtitle{重力势能的情况}
\bch
{\large

上式可以拆成两个独立分布的乘积：
$$f_{MB}(x, y, z, \upsilon_x, \upsilon_y,\upsilon_z) \propto e^{-\frac{m\upsilon^2}{2kT}} e^{-\frac{mgz}{kT}}$$

可以看到，在速度空间的分布和在位置空间的分布互不干扰，所以我们可以得到分子数密度（等价于粒子在位置空间的概率密度）：
$$n = n_0 e^{-\frac{mgz}{kT}}\, ,$$
其中$n_0$为$z=0$处的分子数密度。}
\ech
\end{frame}


\begin{frame}
\chtitle{思考题}
\bch
\addfig{0.5}{think.jpg}
{\Large
假设大气处处温度为$280K$，飞机在地面的压强读数为$1\atm$，起飞后压强读数为$0.8\atm$，请估算飞机的高度。}
\ech
\end{frame}

\begin{frame}
\chtitle{离心力势能}
\bch
{
在旋转参照系中，离心力势能可以写成
$$U(r) = -\frac{1}{2}m\omega^2r^2$$
其中$r$为离旋转中心的径向距离，$\omega$为旋转系相对于惯性系的旋转角速度。

\skipline

根据一样的推导过程，可以得到
$$n = n_0 e^{\frac{m\omega^2r^2}{2kT}}$$
请不要弄错符号，显然是分子被甩了出去，$r$越大分子数密度越高。
}
\ech
\end{frame}


\begin{frame}
\chtitle{思考题}
\bch
\addfig{0.5}{think2.jpg}
{\Large
你能否解释台风的“外围狂风暴雨，中心风和日丽”的奇特现象？}
\ech
\end{frame}

\begin{frame}
\chtitle{麦克斯韦-玻尔兹曼能量分布律}
\bch
{\large
一般地，如果位置空间和速度空间的能量形式没有交叉项，我们可以分离位置空间和速度空间的分布（概率密度），得到分子在相空间的概率密度为：
{\blue $$f_{MB}(x, y, z,\upsilon_x, \upsilon_y,\upsilon_z) = n_0 \left(\frac{m}{2\pi kT}\right)^{3/2} e^{-\frac{\varepsilon}{kT}} $$}
其中能量$\varepsilon$是动能与势能之和：
$$\varepsilon = \frac{1}{2}m\upsilon^2 + U(x,y,z)$$
这是著名的{\blue 麦克斯韦-玻尔兹曼能量分布律}。}
\ech
\end{frame}


\begin{frame}
\chtitle{附录1：多元变量的概率密度函数换元}
\bch

    {\large
      在$n$维空间中，以给定的规则把$\vecx =(x_1,x_2,\ldots,x_n)$映射为$\vecy = (y_1,y_2,\ldots,y_n)$，那么$\vecy$的概率密度函数$F(\vecy)$和$\vecx$的概率密度函数$f(\vecx)$之间有如下关系：


      $$F(\vecy) = \sum_{\vecx \rightarrow \vecy} f(\vecx) \left\vert\frac{\partial \vecx}{\partial \vecy}\right\vert$$
      
      这里的$\left\vert\frac{\partial \vecy}{\partial \vecx}\right\vert$是{\bf Jacobi行列式}。它的物理意义是：$\vecx$的体积元$dx_1dx_2\ldots dx_n$和$\vecy$的体积元$dy_1dy_2\ldots dy_n$之比。

}
\ech
\end{frame}

\begin{frame}
\chtitle{附录2：Jacobi行列式的显式表达}
\bch
{\large
$$ \frac{\partial \vecx}{\partial \vecy} \equiv \frac{\partial (x_1, x_2,\ldots, x_n)}{\partial (y_1, y_2,\ldots, y_n)} \equiv \left\vert
\begin{array}{llll}
  \frac{\partial x_1}{\partial y_1} &   \frac{\partial x_1}{\partial y_2} & \ldots &   \frac{\partial x_1}{\partial y_n}  \\
  \frac{\partial x_2}{\partial y_1} &   \frac{\partial x_2}{\partial y_2} & \ldots &   \frac{\partial x_2}{\partial y_n}  \\
  \ldots & \ldots & \ldots & \ldots \\
  \frac{\partial x_n}{\partial y_1} &   \frac{\partial x_n}{\partial y_2} & \ldots &   \frac{\partial x_n}{\partial y_n}    
\end{array}
\right\vert. $$

也就是说，你要算$n^2$个偏导数，然后求一个$n\times n$方阵的行列式 \bye
}
\ech
\end{frame}


\begin{frame}
\chtitle{附录3: 极坐标的Jacobi行列式}
\bch
利用$x=r\cos\theta$, $y=r\sin\theta$，直接计算
$$
\left\vert
\begin{array}{ll}
  \frac{\partial x}{\partial r}   &   \frac{\partial x}{\partial \theta} \\
  \frac{\partial y}{\partial r}   &   \frac{\partial y}{\partial \theta} \\
\end{array}
\right\vert
 = 
\left\vert
\begin{array}{ll}
  \cos\theta   &   -r\sin\theta \\
  \sin\theta   &   r\cos\theta \\
\end{array}
\right\vert
=r $$
\ech
\end{frame}

\begin{frame}
\chtitle{附录4: 球坐标的Jacobi行列式}
\bch
利用$x=r\cos\sin\theta\cos\varphi$, $y=r\sin\theta\sin\varphi$，$z=r\cos\theta$直接计算
$$
\left\vert
\begin{array}{lll}
  \frac{\partial x}{\partial r}   &   \frac{\partial x}{\partial \theta}  &   \frac{\partial x}{\partial \varphi} \\
  \frac{\partial y}{\partial r}   &   \frac{\partial y}{\partial \theta}  &   \frac{\partial y}{\partial \varphi} \\
  \frac{\partial z}{\partial r}   &   \frac{\partial z}{\partial \theta}  &   \frac{\partial z}{\partial \varphi} 
\end{array}
\right\vert
 = 
\left\vert
\begin{array}{lll}
  \sin\theta\cos\varphi   &   r\cos\theta\cos\varphi & -r\sin\theta\sin\varphi  \\
  \sin\theta\sin\varphi   &   r\cos\theta\sin\varphi & r\sin\theta\cos\varphi  \\
  \cos\theta   &   -r\sin\theta &  0 
\end{array}
\right\vert
= r^2\sin\theta $$
\ech
\end{frame}


\begin{frame}
\chtitle{泻流速率的平均表达式}
\bch
{\large
  泻流速率$\vleak$定义为：{\blue 单位时间从容器壁单位面积的小孔上逸出的分子数和容器内分子数密度之比。}

  \skipline
  
  取小孔所在平面为$xy$平面，速度分布函数为$f(\upsilon_x,\upsilon_y,\upsilon_z)$，则有
\tbox{  $$\vleak = \overline{\frac{\upsilon_z + |\upsilon_z|}{2}}$$}
  教材上也把$\frac{\upsilon_z + |\upsilon_z|}{2}$简写为$\upsilon_z^+$，意思是只取正的$\upsilon_z$。
 
}

\ech
\end{frame}



\begin{frame}
\chtitle{附录5：分布各向同性时泻流速率和平均速率的关系}
\bch

设三维概率密度函数为$f(\upsilon_x, \upsilon_y,\upsilon_z) = g(\upsilon)$ (因各向同性所以可以这样设)，则速率$\upsilon$的概率密度函数为$4\pi\upsilon^2g(\upsilon)$。

不妨设小孔开在$z$方向，在球坐标里计算泻流速率，体积元为$\upsilon^2 d\upsilon \sin\theta d\theta d\varphi$，$\upsilon_z = \upsilon\cos\theta$, 因为取$\upsilon_z^+$，所以$\theta$的积分范围只是$0$到$\pi/2$：


\bea
\vleak &=& \int_0^\infty \upsilon^2 d\upsilon \int_0^{\frac{\pi}{2}} \sin\theta d\theta \int_0^{2\pi} d\varphi \,(\upsilon \cos\theta) g(\upsilon) \newl
&=& \pi \int_0^\infty \upsilon^2 d\upsilon\,  \upsilon g(\upsilon) \newl
&=& \frac{1}{4} \int_0^\infty \upsilon\left(4\pi\upsilon^2g(\upsilon) d\upsilon\right) \newl
&=& \frac{1}{4} \bar{\upsilon}
\eea

二维的情况，用极坐标计算可得结果为$\vleak = \frac{1}{\pi}\overline{\upsilon}$


\ech
\end{frame}

\end{document}
